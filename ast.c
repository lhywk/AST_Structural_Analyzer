#include <stdio.h>
#include <stdlib.h>

// be_start 함수 복원
void be_start() {
    emit(16, "\x7f\x45\x4c\x46\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00");
    emit(16, "\x02\x00\x03\x00\x01\x00\x00\x00\x54\x80\x04\x08\x34\x00\x00\x00");
    emit(16, "\x00\x00\x00\x00\x00\x00\x00\x00\x34\x00\x20\x00\x01\x00\x00\x00");
    emit(16, "\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x80\x04\x08");
    emit(16, "\x00\x80\x04\x08\x10\x4b\x00\x00\x10\x4b\x00\x00\x07\x00\x00\x00");
    emit(16, "\x00\x10\x00\x00\xe8\x00\x00\x00\x00\x89\xc3\x31\xc0\x40\xcd\x80");

    sym_define_global(sym_declare_global("exit"));

    emit(7, "\x5b\x5b\x31\xc0\x40\xcd\x80");

    sym_define_global(sym_declare_global("getchar"));

    emit(10, "\xb8\x03\x00\x00\x00\x31\xdb\x53\x89\xe1");
    emit(10, "\x31\xd2\x42\xcd\x80\x85\xc0\x58\x75\x05");
    emit(6, "\xb8\xff\xff\xff\xff\xc3");

    sym_define_global(sym_declare_global("malloc"));

    emit(4, "\x8b\x44\x24\x04");
    emit(10, "\x50\x31\xdb\xb8\x2d\x00\x00\x00\xcd\x80");
    emit(10, "\x5b\x01\xc3\x50\x53\xb8\x2d\x00\x00\x00");
    emit(8, "\xcd\x80\x5b\x39\xc3\x58\x74\x05");
    emit(6, "\xb8\xff\xff\xff\xff\xc3");

    sym_define_global(sym_declare_global("putchar"));

    emit(8, "\xb8\x04\x00\x00\x00\x31\xdb\x43");
    emit(9, "\x8d\x4c\x24\x04\x89\xda\xcd\x80\xc3");

    save_int(code + 85, codepos - 89);
}

// main1 함수 복원
int main1() {
    code_offset = 134512640;
    be_start();
    nextc = getchar();
    get_token();
    program();
    be_finish();
    return 0;
}

// main 함수 복원
int main() {
    return main1();
}
